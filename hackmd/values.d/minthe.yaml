# helm upgrade --install -n web hackmd stable/hackmd -f hackmd/values.d/minthe.yaml -f hackmd/values.d/minthe.secret.yaml --atomic --debug

image:
  tag: "2.4.1"

ingress:
  enabled: true
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/configuration-snippet: |
      set $uri_userid "x$cookie_userid$uri";
      if ($uri_userid ~ 'x/new') {
        return 302 https://pad.kix.co.il/auth/oauth2;
      }
  path: /
  hosts:
    - host: pad.kix.co.il
      paths:
        - /
  tls: []

postgresql:
  enabled: false

codimd:
  nodeSelector:
    doks.digitalocean.com/node-pool: pool-production
  database:
    type: postgres
    host: postgresql-ha-pgpool.db.svc.cluster.local
    port:
    username: hackmd
    password: xxx
    databaseName: hackmd
  imageUpload:
    storageType: s3
    s3:
      endpoint: eu-central-1.linodeobjects.com
      region: eu-central-1
      accessKeyId: xxx
      secretKey: xxx
      bucket: xxx
  imageStorePersistentVolume:
    enabled: false
  extraEnvironmentVariables:
    CMD_DOMAIN: pad.kix.co.il
  security:
    useCDN: 'false'
    sessionSecret: xxx
    allowGravatar: 'true'
  responseMaxLag: 90
  allowPDFExport: false
  notePermission:
    allowAnonymousEdit: true
    allowAnonymousView: true
  markdown:
    useHardBreak: true
    linkifyHeaderStyle: 'keep-case'
  authentication:
    local:
      enabled: false
      allowRegister: false
    mattermost:
      enabled: true
      domain: https://kix.co.il
      clientId: xxx
      secret: xxx
  connection:
    protocolUseSSL: true
  noteCreation:
    freeUrlEnabled: 'false'
    freeUrlForbiddenNodeIds: 'robots.txt,favicon.ico,api'
    defaultPermission: 'private'
  versionCheck: false
